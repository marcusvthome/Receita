private void renomeiaArquivos(string caminho, bool renomeiaPastas)
       {
           try {
               // Caminho literal da pasta informada 
DirectoryInfo dirInfo = new DirectoryInfo(@caminho);

               // Pega todas as informações dos arquivos dentro do diretório informado 
FileInfo[] arquivos = dirInfo.GetFiles();

               string antigoNome;
               string novoNome;
               int arqAfet = 0, pastasAfet = 0;

               for (int i = 0; i < arquivos.Length; i++)
               {
                   if(arquivos[i].Name.Contains(" ")){

                       // caminho\nome do arquivo antigoNome = @caminho+"\\"+arquivos[i].Name;

                       // caminho\nome_do_arquivo novoNome = @caminho + "\\" + arquivos[i].Name.Replace(" ", "_");

                       // Move o arquivo para a mesma pasta com os carateres substituídos File.Move(antigoNome, novoNome);

                       // Contagem dos arquivos renomeados arqAfet++;
                   }
               }
               // Se caso foi selecionada a opção de renomear as pastas if (renomeiaPastas)
               {
                   // Lista com todas as informações das pastas DirectoryInfo[] pastas = dirInfo.GetDirectories();

                   // itera (efetua um loop) dentro do vetor das pastas for (int i = 0; i < pastas.Length; i++)
                   {
                       if (pastas[i].Name.Contains(" "))
                       {
                           // caminho\nome da pasta antigoNome = @caminho + "\\" + pastas[i].Name;
                           // caminho\nome_da_pasta novoNome = @caminho + "\\" + pastas[i].Name.Replace(" ", "_");

                           Directory.Move(antigoNome, novoNome);

                           // Contagem das pastas renomeadas pastasAfet++;
                       }
                   }
               }
               // Mensagem de sucesso MessageBox.Show(arqAfet + " arquivo(s) e " + pastasAfet + " pasta(s) renomeados com sucesso.",
                               "Operação concluída", MessageBoxButtons.OK, MessageBoxIcon.Information);
           }
           catch(Exception ex)
           {
               // Se der erro, exibe o que aconteceu MessageBox.Show(ex.Message, "Erro", MessageBoxButtons.OK, MessageBoxIcon.Error);
           }
       }